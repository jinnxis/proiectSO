!/bin/bash

# Verifică dacă a fost furnizat un nume de utilizator
if [ -z "$1" ]; then
    echo "Te rog furnizează un nume de utilizator."
    exit 1
fi

USER_NAME=$1
HOME_DIR="/home/$USER_NAME"
REPORT_FILE="$HOME_DIR/raport_$(date +%Y%m%d%H%M%S).txt"

# Verifică dacă directorul home al utilizatorului există
if [ ! -d "$HOME_DIR" ]; then
    echo "Directorul home pentru utilizatorul $USER_NAME nu există."
    exit 1
fi

# Funcție pentru a genera raportul
generate_report() {
    local user_home=$1
    local report_file=$2

    echo "Generare raport pentru utilizatorul $USER_NAME..." > "$report_file"
    echo "-----------------------------------------------" >> "$report_file"

    # Numărul de fișiere
    num_files=$(find "$user_home" -type f | wc -l)
    echo "Numărul de fișiere: $num_files" >> "$report_file"

    # Numărul de directoare
    num_dirs=$(find "$user_home" -type d | wc -l)
    echo "Numărul de directoare: $num_dirs" >> "$report_file"

    # Dimensiunea pe disc a fișierelor
    total_size=$(du -sh "$user_home" | cut -f1)
    echo "Dimensiunea totală pe disc a fișierelor: $total_size" >> "$report_file"

    echo "Raportul a fost generat cu succes la $report_file"
}

# Execută funcția de generare a raportului în fundal
generate_report "$HOME_DIR" "$REPORT_FILE" &

echo "Procesul de generare a raportului a fost pornit în fundal."
